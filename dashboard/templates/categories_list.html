{% extends "dashboard_generic.html" %}

{% block content %}


{% if user.is_staff %}
<!--TODO: Open new IHA Category window-->
<a href="add_category">Add İHA Category</a>
{% endif %}


<table>
    <thead>
    <tr>
        <th>Name</th>
        <th>Added Date</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    {% for category in categories %}
    <tr>
        <td>
            {{ category.name }}
        </td>
        <td>
            {{ category.added_date }}
        </td>

        <td>
            <!--            TODO: Open edit popup.-->
            <button type="button" onclick="editCategory({{ category.id }})">Edit</button>
            <button type="button" onclick="deleteCategory({{ category.id }})">Delete</button>

        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>

<script>

    function editCategory(categoryID) {
    }

    function deleteCategory(categoryID) {
        if (confirm('Are you sure you want to delete this category?')) {
            const csrfToken = getCookie('csrftoken');
            fetch(categoryID, {
                method: 'DELETE',
                headers: {
                    'X-CSRFToken': csrfToken
                }
            })
                .then(response => response.json())
                .then(data => {
                    if (data.message) {
                        alert(data);
                    } else {
                        alert('İHA Category deleted successfully')
                    }
                });
        }
    }
</script>

{% endblock %}
