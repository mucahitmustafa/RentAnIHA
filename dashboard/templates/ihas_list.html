{% extends "dashboard_generic.html" %}

{% block content %}


{% if user.is_staff %}
<!--TODO: Open new IHA window-->
<a href="add_iha">Add İHA</a>
{% endif %}

<p>{{ categories }}</p>


<table>
    <thead>
    <tr>
        <th>Category</th>
        <th>Brand</th>
        <th>Model</th>
        <th>Weight</th>
        <th>Serial Number</th>
        <th>Added Date</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    {% for iha in ihas %}
    <tr>
        <td>
            {{ iha.category }}
        </td>
        <td>
            {{ iha.brand }}
        </td>
        <td>
            {{ iha.model }}
        </td>
        <td>
            {{ iha.weight }}
        </td>
        <td>
            {{ iha.serial_number }}
        </td>
        <td>
            {{ iha.added_date }}
        </td>
        <td>
            <a href="{{ iha.id }}">Detail</a>

            {% if user.is_staff %}
            <!--            TODO: Open edit popup.-->
            <button type="button" onclick="editIha({{ iha.id }})">Edit</button>
            <button type="button" onclick="deleteIha({{ iha.id }})">Delete</button>
            {% else %}
            <!--            TODO: Open rent popup.-->
            <button type="button" onclick="rentIha({{ iha.id }})">Rent</button>
            {% endif %}

        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>

<script>

    function rentIha(ihaID) {
    }

    function editIha(ihaID) {
    }

    function deleteIha(ihaID) {
        if (confirm('Are you sure you want to delete this IHA?')) {
            const csrfToken = getCookie('csrftoken');
            fetch(ihaID, {
                method: 'DELETE',
                headers: {
                    'X-CSRFToken': csrfToken
                }
            })
                .then(response => response.json())
                .then(data => {
                    if (data.message) {
                        alert(data);
                    } else {
                        alert('İHA deleted successfully')
                    }
                });
        }
    }
</script>

{% endblock %}
